2019-04-26 17:54:08,899 [DEBUG] Using GPU 0
2019-04-26 17:54:08,925 [DEBUG] CACHEDIR=/home/thinh/.cache/matplotlib
2019-04-26 17:54:08,926 [DEBUG] Using fontManager instance from /home/thinh/.cache/matplotlib/fontlist-v300.json
2019-04-26 17:54:08,998 [DEBUG] Loaded backend agg version unknown.
2019-04-26 17:54:13,412 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_03.h5
2019-04-26 17:54:13,412 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:54:27,597 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 0.98%
2019-04-26 17:54:27,597 [INFO] Dataset UCSD_ped1: Overall AUC = 86.94%
2019-04-26 17:54:27,762 [DEBUG] update_title_pos
2019-04-26 17:54:27,768 [DEBUG] findfont: Matching :family=sans-serif:style=normal:variant=normal:weight=normal:stretch=normal:size=10.0 to DejaVu Sans ('/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf') with score of 0.050000.
2019-04-26 17:54:27,966 [DEBUG] findfont: Matching :family=sans-serif:style=normal:variant=normal:weight=normal:stretch=normal:size=12.0 to DejaVu Sans ('/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf') with score of 0.050000.
2019-04-26 17:54:27,979 [DEBUG] update_title_pos
2019-04-26 17:54:28,173 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_04.h5
2019-04-26 17:54:28,173 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:54:40,351 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 3.26%
2019-04-26 17:54:40,351 [INFO] Dataset UCSD_ped1: Overall AUC = 95.18%
2019-04-26 17:54:40,512 [DEBUG] update_title_pos
2019-04-26 17:54:40,719 [DEBUG] update_title_pos
2019-04-26 17:54:40,911 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_14.h5
2019-04-26 17:54:40,911 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:54:53,008 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 18.77%
2019-04-26 17:54:53,008 [INFO] Dataset UCSD_ped1: Overall AUC = 93.02%
2019-04-26 17:54:53,172 [DEBUG] update_title_pos
2019-04-26 17:54:53,385 [DEBUG] update_title_pos
2019-04-26 17:54:53,590 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_18.h5
2019-04-26 17:54:53,591 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:55:05,609 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 1.34%
2019-04-26 17:55:05,610 [INFO] Dataset UCSD_ped1: Overall AUC = 92.39%
2019-04-26 17:55:05,769 [DEBUG] update_title_pos
2019-04-26 17:55:05,982 [DEBUG] update_title_pos
2019-04-26 17:55:06,181 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_19.h5
2019-04-26 17:55:06,181 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:55:18,325 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 20.03%
2019-04-26 17:55:18,326 [INFO] Dataset UCSD_ped1: Overall AUC = 97.10%
2019-04-26 17:55:18,483 [DEBUG] update_title_pos
2019-04-26 17:55:18,702 [DEBUG] update_title_pos
2019-04-26 17:55:18,899 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_21.h5
2019-04-26 17:55:18,899 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:55:30,951 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 19.49%
2019-04-26 17:55:30,951 [INFO] Dataset UCSD_ped1: Overall AUC = 96.60%
2019-04-26 17:55:31,110 [DEBUG] update_title_pos
2019-04-26 17:55:31,324 [DEBUG] update_title_pos
2019-04-26 17:55:31,525 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_22.h5
2019-04-26 17:55:31,525 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:55:43,725 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 3.83%
2019-04-26 17:55:43,725 [INFO] Dataset UCSD_ped1: Overall AUC = 96.24%
2019-04-26 17:55:43,884 [DEBUG] update_title_pos
2019-04-26 17:55:44,098 [DEBUG] update_title_pos
2019-04-26 17:55:44,296 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_23.h5
2019-04-26 17:55:44,296 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:55:56,452 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 4.65%
2019-04-26 17:55:56,452 [INFO] Dataset UCSD_ped1: Overall AUC = 93.65%
2019-04-26 17:55:56,607 [DEBUG] update_title_pos
2019-04-26 17:55:56,820 [DEBUG] update_title_pos
2019-04-26 17:55:57,025 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_24.h5
2019-04-26 17:55:57,025 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:56:09,146 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 12.08%
2019-04-26 17:56:09,146 [INFO] Dataset UCSD_ped1: Overall AUC = 94.38%
2019-04-26 17:56:09,303 [DEBUG] update_title_pos
2019-04-26 17:56:09,523 [DEBUG] update_title_pos
2019-04-26 17:56:09,720 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_32.h5
2019-04-26 17:56:09,720 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:56:21,799 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 9.44%
2019-04-26 17:56:21,799 [INFO] Dataset UCSD_ped1: Overall AUC = 95.98%
2019-04-26 17:56:21,958 [DEBUG] update_title_pos
2019-04-26 17:56:22,170 [DEBUG] update_title_pos
2019-04-26 17:56:34,031 [CRITICAL] Uncaught exception
Traceback (most recent call last):
  File "/home/thinh/github/anomaly-detection-and-localization/start_test.py", line 73, in <module>
    visualize_score=True, visualize_frame=True)
  File "/home/thinh/github/anomaly-detection-and-localization/classifier.py", line 598, in test
    calc_auc_pixel(logger, dataset, n_videos[dataset], save_path, rte)
  File "/home/thinh/github/anomaly-detection-and-localization/classifier.py", line 258, in calc_auc_pixel
    auc = roc_auc_score(all_gt, all_pred)
  File "/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/sklearn/metrics/ranking.py", line 352, in roc_auc_score
    y_true = label_binarize(y_true, labels)[:, 0]
  File "/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/sklearn/preprocessing/label.py", line 639, in label_binarize
    shape=(n_samples, n_classes))
  File "/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/scipy/sparse/compressed.py", line 68, in __init__
    dtype=idx_dtype)
MemoryError
