2019-04-26 17:59:06,678 [DEBUG] Using GPU 0
2019-04-26 17:59:06,704 [DEBUG] CACHEDIR=/home/thinh/.cache/matplotlib
2019-04-26 17:59:06,706 [DEBUG] Using fontManager instance from /home/thinh/.cache/matplotlib/fontlist-v300.json
2019-04-26 17:59:06,777 [DEBUG] Loaded backend agg version unknown.
2019-04-26 17:59:11,202 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_03.h5
2019-04-26 17:59:11,202 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:59:25,237 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 0.98%
2019-04-26 17:59:25,237 [INFO] Dataset UCSD_ped1: Overall AUC = 86.94%
2019-04-26 17:59:25,400 [DEBUG] update_title_pos
2019-04-26 17:59:25,407 [DEBUG] findfont: Matching :family=sans-serif:style=normal:variant=normal:weight=normal:stretch=normal:size=10.0 to DejaVu Sans ('/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf') with score of 0.050000.
2019-04-26 17:59:25,609 [DEBUG] findfont: Matching :family=sans-serif:style=normal:variant=normal:weight=normal:stretch=normal:size=12.0 to DejaVu Sans ('/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/matplotlib/mpl-data/fonts/ttf/DejaVuSans.ttf') with score of 0.050000.
2019-04-26 17:59:25,619 [DEBUG] update_title_pos
2019-04-26 17:59:25,815 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_04.h5
2019-04-26 17:59:25,815 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:59:37,979 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 3.26%
2019-04-26 17:59:37,979 [INFO] Dataset UCSD_ped1: Overall AUC = 95.18%
2019-04-26 17:59:38,142 [DEBUG] update_title_pos
2019-04-26 17:59:38,354 [DEBUG] update_title_pos
2019-04-26 17:59:38,551 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_14.h5
2019-04-26 17:59:38,551 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 17:59:50,818 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 18.77%
2019-04-26 17:59:50,818 [INFO] Dataset UCSD_ped1: Overall AUC = 93.02%
2019-04-26 17:59:50,981 [DEBUG] update_title_pos
2019-04-26 17:59:51,196 [DEBUG] update_title_pos
2019-04-26 17:59:51,398 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_18.h5
2019-04-26 17:59:51,398 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 18:00:03,526 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 1.34%
2019-04-26 18:00:03,526 [INFO] Dataset UCSD_ped1: Overall AUC = 92.39%
2019-04-26 18:00:03,687 [DEBUG] update_title_pos
2019-04-26 18:00:03,896 [DEBUG] update_title_pos
2019-04-26 18:00:04,088 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_19.h5
2019-04-26 18:00:04,088 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 18:00:16,086 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 20.03%
2019-04-26 18:00:16,086 [INFO] Dataset UCSD_ped1: Overall AUC = 97.10%
2019-04-26 18:00:16,242 [DEBUG] update_title_pos
2019-04-26 18:00:16,472 [DEBUG] update_title_pos
2019-04-26 18:00:16,671 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_21.h5
2019-04-26 18:00:16,671 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 18:00:28,650 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 19.49%
2019-04-26 18:00:28,650 [INFO] Dataset UCSD_ped1: Overall AUC = 96.60%
2019-04-26 18:00:28,808 [DEBUG] update_title_pos
2019-04-26 18:00:29,020 [DEBUG] update_title_pos
2019-04-26 18:00:29,215 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_22.h5
2019-04-26 18:00:29,216 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 18:00:41,206 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 3.83%
2019-04-26 18:00:41,206 [INFO] Dataset UCSD_ped1: Overall AUC = 96.24%
2019-04-26 18:00:41,363 [DEBUG] update_title_pos
2019-04-26 18:00:41,568 [DEBUG] update_title_pos
2019-04-26 18:00:41,760 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_23.h5
2019-04-26 18:00:41,760 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 18:00:53,741 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 4.65%
2019-04-26 18:00:53,741 [INFO] Dataset UCSD_ped1: Overall AUC = 93.65%
2019-04-26 18:00:53,899 [DEBUG] update_title_pos
2019-04-26 18:00:54,107 [DEBUG] update_title_pos
2019-04-26 18:00:54,306 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_24.h5
2019-04-26 18:00:54,306 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 18:01:06,285 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 12.08%
2019-04-26 18:01:06,285 [INFO] Dataset UCSD_ped1: Overall AUC = 94.38%
2019-04-26 18:01:06,442 [DEBUG] update_title_pos
2019-04-26 18:01:06,649 [DEBUG] update_title_pos
2019-04-26 18:01:06,851 [INFO] ==> VIDEO_ROOT_PATH/UCSD_ped1/testing_h5_t0/UCSD_ped1_32.h5
2019-04-26 18:01:06,851 [DEBUG] Predicting using logs/UCSD_ped1/jobs/f5846318-6990-4622-b584-ececf33a54d7/model_snapshot_e298_0.003159.h5
2019-04-26 18:01:18,900 [INFO] Dataset UCSD_ped1: Overall PR-AUC = 9.44%
2019-04-26 18:01:18,900 [INFO] Dataset UCSD_ped1: Overall AUC = 95.98%
2019-04-26 18:01:19,057 [DEBUG] update_title_pos
2019-04-26 18:01:19,268 [DEBUG] update_title_pos
2019-04-26 18:01:29,029 [CRITICAL] Uncaught exception
Traceback (most recent call last):
  File "/home/thinh/github/anomaly-detection-and-localization/start_test.py", line 73, in <module>
    visualize_score=True, visualize_frame=True)
  File "/home/thinh/github/anomaly-detection-and-localization/classifier.py", line 598, in test
    calc_auc_pixel(logger, dataset, n_videos[dataset], save_path, rte)
  File "/home/thinh/github/anomaly-detection-and-localization/classifier.py", line 258, in calc_auc_pixel
    auc = roc_auc_score(all_gt, all_pred)
  File "/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/sklearn/metrics/ranking.py", line 352, in roc_auc_score
    y_true = label_binarize(y_true, labels)[:, 0]
  File "/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/sklearn/preprocessing/label.py", line 639, in label_binarize
    shape=(n_samples, n_classes))
  File "/home/thinh/miniconda3/envs/ano/lib/python3.6/site-packages/scipy/sparse/compressed.py", line 68, in __init__
    dtype=idx_dtype)
MemoryError
